# TODO 列表（结合课题目标与当前实现）

## 数据与环境（社交舆情 + 链上账本）
- [ ] 舆情数据完善：补充更丰富的正/负面、多模态推文样本（含虚假信息案例），标注情绪/可信度元数据；支持按情绪/来源过滤检索。
- [ ] 链上仿真增强：为账本增加更丰富的合约状态/事件，补充多网络/多代币样例；在 RAG/防御中明确“链上为事实基准”的提示与使用流程。
- [ ] 数据注入工具：提供脚本/前端入口快速增量导入舆情文档与图片，便于构造攻击样本。

## Agent 与 RAG（已部分实现：本地 Chroma、tweets 注入、tools/RAG 自动串联）
- [ ] RAG 召回质量：增加检索重排/去重，命中文档与来源在 trace/UI 中展示；支持按情绪/可信度过滤（利用元数据）。
- [ ] 投毒防护：对 unsafe 语料做基础检测（长度/关键词/来源黑名单），命中时在回复中显式提示风险；设计“高权重伪造文本”注入剧本并验证防御。
- [ ] 情绪分析/决策演示：在回复中显式展示情绪判断与决策依据（RAG / 链上快照 / 视觉判定），以支撑“模拟交易决策”场景。

## 视觉一致性（已实现：本地 Florence Caption + 远程文本判定，可选远程多模态）
- [ ] 远程文本判定稳健化：为 `VISION_REMOTE_TEXT_*` 调用增加超时、重试、失败回退策略；记录使用路径与结果到 trace。
- [ ] 多模态直判完善：为 `VISION_REMOTE_MM_*` 增加频控/失败回退（如失败时标记 ERROR，不阻塞主流程）；可选比对多次采样或置信度。
- [ ] 防护与校验：对空/极短 caption 或异常响应直接标记 ERROR；可选双模型互证（文本判定 + 多模态互相佐证）。

## 攻击场景与演示（已具备内存注入、RAG 投毒按钮）
- [ ] 扩充攻击剧本：添加“高权重跑路伪造文本”与“图文不符趋势图”示例；在控制台一键触发并对比有/无防御下的决策差异。
- [ ] 记忆篡改/提示注入：设计对话式注入案例，观察防御链路响应；必要时增加上下文清洗/截断策略。

## 防御框架与安全策略
- [ ] 链上-链下一致性核查：在高风险舆情场景中，自动调用链上工具核查关键实体/资金流，若冲突则显式拦截或警示。
- [ ] 安全策略收敛：为工具调用加白名单/风险分级，异常时阻断或降级；为视觉/远程调用增加速率与并发限制。

## 前端与体验（已实现基础双通道 UI）
- [ ] 流式/状态提示：增加回复流式输出或“生成中”状态，减少等待空白。
- [ ] 调试视图结构化：分区展示系统提示、RAG 命中、视觉 caption/判定、工具调用链；标注使用的视觉路径（本地+远程文本 / 远程多模态）。
- [ ] RAG/视觉来源展示：在回复中或 UI 区域列出命中文档/图片来源与判定结果。

## 观察与运维
- [ ] 健康/就绪探针：为前端补充探针；MCP/前端日志输出路径与滚动策略。
- [ ] 基础指标：记录工具成功率、视觉判定通过率、RAG 命中率到日志或简单 metrics 端点（可先文本日志）。

## 测试与 CI
- [ ] 扩充 `scripts/test_mcp_tools.py` 覆盖主要工具与异常路径。
- [ ] 视觉/RAG 集成测试：使用固定图片+描述与固定检索语料，验证判定与命中结果；可在 CI 中跑最小无网用例。
