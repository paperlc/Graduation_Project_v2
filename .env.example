# =========================
# 大模型（OpenAI 兼容）基础配置
# =========================
LLM_API_KEY=your-openai-or-local-key
LLM_API_BASE=
LLM_MODEL=gpt-4o-mini

# 兼容 OpenAI 官方变量
OPENAI_API_KEY=
OPENAI_BASE_URL=

# =========================
# Embedding 配置（本地 RAG 需要；二选一：本地模型 或 远程 OpenAI 兼容接口）
# =========================
# 本地 embedding（推荐；无网也可，指定模型名或本地路径，支持逗号分隔候选）
EMBEDDING_USE_LOCAL=true
EMBEDDING_LOCAL_MODEL=
EMBEDDING_LOCAL_MODELS=
# 远程 embedding（OpenAI 兼容；仅当 EMBEDDING_USE_REMOTE=true 时生效）
EMBEDDING_USE_REMOTE=false
EMBEDDING_API_KEY=
EMBEDDING_API_BASE=
EMBEDDING_MODEL=text-embedding-3-small
# 向量库持久化目录（留空则使用内存，不持久化）
CHROMA_PATH=

# =========================
# RAG 配置（开关与数据源）
# =========================
# 模式：local（本地 Chroma）| remote（远程 HTTP）| off（关闭 RAG）
RAG_PROVIDER=local
# 本地 RAG 选项（local 时有效）
RAG_TWEET_FILE=
RAG_COLLECTION_SAFE=
RAG_COLLECTION_UNSAFE=
RAG_AUTO_INGEST=true          # quickstart 启动时自动 ingest
RAG_RESET_COLLECTIONS=true     # ingest 前清空集合，避免重复
RAG_RESET_STORAGE=false        # true 时清空 CHROMA_PATH 后再 ingest
# 远程 RAG（remote 时有效，POST {query, top_k}）
RAG_REMOTE_URL=
RAG_REMOTE_API_KEY=

# =========================
# 视觉管线配置（本地 Caption + 远程判定，或远程多模态直判）
# ---------------------------------------------------------
# 开关：false 时完全跳过视觉一致性检测
VISION_ENABLED=true
# 本地 Caption/VLM：在本地生成图片描述（默认 Florence-2-base）
#   - 启用：设为 true；禁用：false（改用远程多模态直判）
#   - 模型：可填 Hugging Face 路径或本地目录
VISION_LOCAL_CAPTION_ENABLED=true
VISION_LOCAL_CAPTION_MODEL=microsoft/Florence-2-base
# 远程文本判定：将 “用户文本+本地描述” 发给 LLM 判定一致/不一致
#   - API KEY / BASE：指向远程 LLM（仅文本）服务
#   - MODEL：文本判定用的模型名（示例 gpt-4o-mini 或你部署的 LLM）
VISION_REMOTE_TEXT_API_KEY=
VISION_REMOTE_TEXT_API_BASE=
VISION_REMOTE_TEXT_MODEL=gpt-4o-mini
# 远程多模态判定：直接将图+文发给多模态模型判定一致/不一致（不依赖本地 Caption）
#   - 启用：设为 true；禁用：false
#   - API KEY / BASE：指向远程多模态服务
#   - MODEL：多模态模型名（示例 gpt-4o-mini 或你部署的多模态模型）
VISION_REMOTE_MM_ENABLED=false
VISION_REMOTE_MM_API_KEY=
VISION_REMOTE_MM_API_BASE=
VISION_REMOTE_MM_MODEL=gpt-4o-mini

# =========================
# 默认防御开关
# =========================
DEFENSE_DEFAULT_ON=true
TOOL_CALL_MAX_ROUNDS=3
LOG_LEVEL=WARNING

# =========================
# 账本文件路径（可选）
# =========================
# 默认使用 data/ledger/ledger.json 作为初始化种子；可设 LEDGER_DB 指向 SQLite 账本文件。
LEDGER_FILE=
LEDGER_DB=

# =========================
# MCP 客户端
# =========================
# 常驻 MCP 服务（推荐）：先在一端启动 MCP，再在前端侧配置 URL。
#   MCP_TRANSPORT=sse MCP_HOST=0.0.0.0 MCP_PORT=8001 MCP_SSE_PATH=/sse python -m src.simulation.server
# 前端/.env 设置 URL（如需鉴权头，设 MCP_SERVER_HEADERS='{\"Authorization\":\"Bearer xxx\"}'）
MCP_SERVER_URL=http://127.0.0.1:8001/sse
# 如需回退到本地子进程模式（非推荐）再设置： MCP_SERVER_CMD=python -m src.simulation.server
MCP_SERVER_CMD=
HEALTH_HOST=0.0.0.0
HEALTH_PORT=8081
TOOL_CALL_TIMEOUT=15
TOOL_CALL_RETRIES=1

# 双通道（防御/无防御）MCP 服务端与账本
MCP_SERVER_URL_SAFE=
MCP_SERVER_URL_UNSAFE=
MCP_HOST_SAFE=
MCP_HOST_UNSAFE=
MCP_PORT_SAFE=
MCP_PORT_UNSAFE=
MCP_SSE_PATH_SAFE=
MCP_SSE_PATH_UNSAFE=
LEDGER_DB_SAFE=
LEDGER_DB_UNSAFE=
LEDGER_SNAPSHOT_RETENTION=5
HEALTH_PORT_SAFE=
HEALTH_PORT_UNSAFE=
